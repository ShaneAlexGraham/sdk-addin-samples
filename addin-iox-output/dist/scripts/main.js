"use strict";geotab.addin.ioxOutput=function(){function n(e){m.innerHTML=e}function i(t){setTimeout(function(){a.call("Get",{typeName:"TextMessage",search:{id:t.split("-")[0]}},function(e){e[0].delivered?document.getElementById(t).innerHTML+=", Delivered: "+new Date(e[0].delivered):i(t)},n)},1e3)}function o(e){var t=e+"-"+Date.now(),n=document.createElement("h4"),e=document.createTextNode("Sent: "+new Date);n.setAttribute("id",t),n.appendChild(e),s.appendChild(n),i(t)}function d(){var e=l.value,t=p.options[p.selectedIndex].text;a.call("Add",{typeName:"TextMessage",entity:{device:{id:e},messageContent:{isRelayOn:"On"===t,contentType:"IoxOutput"},isDirectionToVehicle:!0}},o,n)}function u(e,t){return(e=e.name.toLowerCase())===(t=t.name.toLowerCase())?0:t<e?1:-1}var a,c,l,r,s,m,p;return{initialize:function(e,t,n){a=e,c=document.getElementById("ioxoutput"),l=document.getElementById("ioxoutput-vehicles"),r=document.getElementById("ioxoutput-send"),s=document.getElementById("ioxoutput-history"),m=document.getElementById("ioxoutput-error"),p=document.getElementById("ioxoutput-state"),l.addEventListener("change",function(){r.disabled=!1}),r.addEventListener("click",d),n()},focus:function(e){(a=e).call("Get",{typeName:"Device",resultsLimit:1e3,search:{fromDate:(new Date).toISOString()}},function(e){if(e&&!(e.length<1)){e.sort(u),l.innerHTML="";for(var t=0;t<e.length;t++){var n=new Option;n.text=e[t].name,n.value=e[t].id,l.add(n)}r.disabled=!1,c.style.display=""}},n)},blur:function(){r.disabled=!0,c.style.display="none"}}};